
<p style="color: green"><%= notice %></p>

<h1>Comments in <%= @post.title %></h1>

<%= link_to "New comment", new_topic_post_comment_path(@topic, @post) %>
<br>
<br>

<div id="comments">
  <% if @comments.any? %>
    <table style="width:100%">
      <thead>
      <tr>
        <th>Comments</th>
        <th>User email</th>
        <th>add ratings</th>
        <th>Show</th>
        <th>Edit</th>
        <th>Delete</th>
      </tr>
      </thead>
      <tbody>
      <% @comments.each do |comment| %>
        <tr>
          <td><%= comment.text %><% link_to 'View Ratings', new_topic_post_comment_user_comment_rating_path(@topic, @post, comment) %></td>
          <td><%= comment.user.present? ? comment.user.email : 'No user id' %>
           <td> <%= form_for([@topic, @post, comment, UserCommentRating.new], url: topic_post_comment_user_comment_ratings_path(comment.post.topic, comment.post, comment), remote: true )do |f| %>
               <%= f.hidden_field :comment_id, value: comment.id %>
               <div class="form-group">
                 <%= f.label :value %>
                 <%= f.select :value, (1..5).to_a, prompt: 'Select a rating' %>
               </div>

               <%= f.submit 'Rate Comment', class: 'btn btn-primary'%>
             <% end %></td>


          <td><%= link_to "Show", topic_post_comment_path(@topic, @post, comment) %></td>
          <td><%= link_to "Edit", edit_topic_post_comment_path(@topic, @post, comment) %></td>
          <td><%= button_to "Delete", topic_post_comment_path(@topic, @post, comment), method: :delete %></td>
        </tr>
      <% end %>
      </tbody>
    </table>
  <% else %>
    No comments
  <% end %>
</div>
<br>

<%= link_to "Back to post", request.referer, class: "btn btn-secondary" %>
